<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bootstrap Admin Dashboard</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css"
    />
    <!-- <script src="https://kit.fontawesome.com/ae360af17e.js" crossorigin="anonymous"></script> -->
    <link rel="stylesheet" href="../../css/style.css" />
  </head>

  <body>
    <div class="wrapper">
      <aside id="sidebar" class="js-sidebar">
        <div class="h-100">
          <div class="sidebar-logo">
            <a href="#">TripAura</a>
          </div>
          <a
            href="#"
            class="sidebar-link collapsed"
            data-bs-target="#thongke"
            data-bs-toggle="collapse"
            aria-expanded="false"
            ><i class="fa-solid fa-file-lines pe-2"></i>
            Thống kê
          </a>
          <ul
            id="thongke"
            class="sidebar-dropdown list-unstyled collapse"
            data-bs-parent="#sidebar"
          >
            <li class="sidebar-item">
              <a href="../thongkes/DoanhThu.html" class="sidebar-link"
                >Doanh thu</a
              >
            </li>
          </ul>
          <li class="sidebar-item">
            <a
              href="#"
              class="sidebar-link collapsed"
              data-bs-target="#pages"
              data-bs-toggle="collapse"
              aria-expanded="false"
              ><i class="fa-solid fa-file-lines pe-2"></i>
              Category
            </a>
            <ul
              id="pages"
              class="sidebar-dropdown list-unstyled collapse"
              data-bs-parent="#sidebar"
            >
              <li class="sidebar-item">
                <a href="./Listcategory.html" class="sidebar-link"
                  >List Category</a
                >
              </li>
              <li class="sidebar-item">
                <a href="./Addcategory.html" class="sidebar-link"
                  >Add Category</a
                >
              </li>
            </ul>
          </li>

          <!-- Repeated sidebar structure for other links ... -->
        </div>
      </aside>

      <div class="main">
        <nav class="navbar navbar-expand px-3 border-bottom">
          <button class="btn" id="sidebar-toggle" type="button">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse navbar">
            <ul class="navbar-nav">
              <li class="nav-item dropdown">
                <a href="#" data-bs-toggle="dropdown" class="nav-icon pe-md-0">
                  <img
                    src="../../image/profile.jpg"
                    class="avatar img-fluid rounded"
                    alt=""
                  />
                </a>
                <div class="dropdown-menu dropdown-menu-end">
                  <a href="#" class="dropdown-item">Profile</a>
                  <a href="#" class="dropdown-item">Setting</a>
                  <a href="./Login.html" class="dropdown-item">Logout</a>
                </div>
              </li>
            </ul>
          </div>
        </nav>

        <main class="content px-3 py-2">
          <div class="container-fluid">
            <div class="card border-0 mb-4">
              <div class="card-header">
                <h5 class="card-title">List Category</h5>
              </div>
              <div class="container mt-3">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th></th>
                      <th>Category name</th>
                      <th>Category image</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody id="listcate"></tbody>
                </table>
              </div>
            </div>
          </div>
        </main>

        <a href="#" class="theme-toggle">
          <i class="fa-regular fa-moon"></i>
          <i class="fa-regular fa-sun"></i>
        </a>

        <footer class="footer">
          <div class="container-fluid">
            <div class="row text-muted">
              <div class="col-6 text-start">
                <p class="mb-0">
                  <a href="#" class="text-muted">
                    <strong>CodzSwod</strong>
                  </a>
                </p>
              </div>
              <div class="col-6 text-end">
                <ul class="list-inline">
                  <li class="list-inline-item">
                    <a href="#" class="text-muted">Contact</a>
                  </li>
                  <li class="list-inline-item">
                    <a href="#" class="text-muted">About Us</a>
                  </li>
                  <li class="list-inline-item">
                    <a href="#" class="text-muted">Terms</a>
                  </li>
                  <li class="list-inline-item">
                    <a href="#" class="text-muted">Booking</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </footer>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../js/script.js"></script>

    <script>
      var str = "";
      var i = 1;
      fetch("https://trip-aura-server.vercel.app/category/api/getCategory")
        .then((response) => response.json())
        .then((responseData) => {
          console.log(responseData);

          const data = Array.isArray(responseData)
            ? responseData
            : responseData.data;

          if (Array.isArray(data)) {
            str = "";
            data.forEach((item) => {
              str += `<tr>
                    <td>${i++}</td>
                    <td>${item.name}</td>
                    <td><img src="${item.icon}" alt="${
                item.name
              }" style="width: 50px; height: 50px;"></td>
                    <td class="text-center">
                      <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                        <button class="btn btn-primary rounded" data-bs-toggle="modal" data-bs-target="#editCategoryModal">Edit</button>
                        <div class="mx-3"></div>
                        <button class="btn btn-danger rounded">Delete</button>
                      </div>
                    </td>
                  </tr>`;
            });
            str += "</tbody>";
            document.getElementById("listcate").innerHTML = str;
          } else {
            console.error("Error: Expected an array but received:", data);
          }
        })
        .catch((error) => {
          console.error("Error fetching data:", error);
        });
    </script>
  </body>
</html>

<!-- Modal for editing category -->
<div
  class="modal fade"
  id="editCategoryModal"
  tabindex="-1"
  aria-labelledby="editCategoryModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editCategoryModalLabel">Edit Category</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <!-- Form for editing category -->
        <form id="editCategoryForm">
          <div class="form-group">
            <label for="categoryName">Category Name</label>
            <input
              type="text"
              class="form-control"
              id="categoryName"
              placeholder="Name"
              required
            />
          </div>
          <div class="form-group">
            <label for="categoryImage">Category Image</label>
            <input
              type="text"
              class="form-control"
              id="categoryImage"
              placeholder="Image"
              required
            />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
        <button type="button" class="btn btn-primary" onclick="saveCategory()">
          Save
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  function saveCategory() {
    var categoryName = document.getElementById("categoryName").value;
    var categoryImage = document.getElementById("categoryImage").value;

    // Check if fields are empty
    if (categoryName === "" || categoryImage === "") {
      alert("Please fill in both fields.");
      return;
    }

    console.log("Category Name:", categoryName);
    console.log("Category Image:", categoryImage);

    // Close modal after saving
    $("#editCategoryModal").modal("hide");

    // Optional: Reset form content after saving
    document.getElementById("editCategoryForm").reset();
  }
</script>
